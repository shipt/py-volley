team: "machine-learning"
prometheus:
  - name: "bundle-engine-queue-size"
    expression: rsmq_queue_length > 10
    period: "5m"
    team: "machine-learning"
    priority: p1
    region: ["us-east-1"]
    runbook: ""
    environment: ["production", "staging"]
    description: "ml-bundle-engine queue size too large"

  - name: "bundle-engine-consumer-group-lag-production"
    expression: sum(kafka_consumergroup_lag{topic=~"prd.bus.ds-marketplace.v1.bundle_engine_input", consumergroup="group1"}) by (consumergroup, topic) > 0
    period: "5m"
    team: "machine-learning"
    priority: p1
    region: ["us-east-1"]
    runbook: ""
    environment: ["production"]
    description: "production input topic lag too large"

  - name: "bundle-engine-consumer-group-lag-staging"
    expression: sum(kafka_consumergroup_lag{topic=~"stg.bus.ds-marketplace.v1.bundle_engine_input", consumergroup="group1"}) by (consumergroup, topic) > 0
    period: "5m"
    team: "machine-learning"
    priority: p1
    region: ["us-east-1"]
    runbook: ""
    environment: ["staging"]
    description: "staging input topic lag too large"
