
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-7.3.6">
    
    
      
        <title>Getting Started - Volley</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.a57b2b03.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    
      


    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
      <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#getting-started" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Volley" class="md-header__button md-logo" aria-label="Volley" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Volley
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Getting Started
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Volley" class="md-nav__button md-logo" aria-label="Volley" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Volley
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Volley
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Getting Started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Getting Started
      </a>
      
        


<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-define-data-models" class="md-nav__link">
    1. Define data models
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-queue-configuration" class="md-nav__link">
    2. Queue configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-initialize-the-engine" class="md-nav__link">
    3. Initialize the Engine
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-decorate-the-function" class="md-nav__link">
    4. Decorate the function
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-run-application" class="md-nav__link">
    5. Run application
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Configuration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Configuration" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Configuration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../queue_config/" class="md-nav__link">
        Queues
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../profiles/" class="md-nav__link">
        Profiles
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../engine/" class="md-nav__link">
        Application
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../connectors/connectors/" class="md-nav__link">
        Consumer & Producer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../serializers/overview/" class="md-nav__link">
        Serialization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../models/overview/" class="md-nav__link">
        Model Handlers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../deadletterqueue/" class="md-nav__link">
        Dead Letter Queues
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../metrics/" class="md-nav__link">
        Metrics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../advanced_example/" class="md-nav__link">
        Advanced Example
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Extending Volley
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Extending Volley" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Extending Volley
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../extending/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_2" type="checkbox" id="__nav_6_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6_2">
          Connectors
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Connectors" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_2">
          <span class="md-nav__icon md-icon"></span>
          Connectors
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../connectors/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../connectors/kafka/" class="md-nav__link">
        ConfluentKafka
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../connectors/rsmq/" class="md-nav__link">
        RSMQ
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_3" type="checkbox" id="__nav_6_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6_3">
          Serializers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Serializers" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_3">
          <span class="md-nav__icon md-icon"></span>
          Serializers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../serializers/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../serializers/BaseSerialization/" class="md-nav__link">
        BaseSerialization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../serializers/JsonSerialization/" class="md-nav__link">
        JsonSerialization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../serializers/MsgPackSerialization/" class="md-nav__link">
        MsgPackSerialization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../serializers/OrJsonSerialization/" class="md-nav__link">
        OrJsonSerialization
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_4" type="checkbox" id="__nav_6_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6_4">
          Model Handlers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Model Handlers" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_4">
          <span class="md-nav__icon md-icon"></span>
          Model Handlers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../models/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../models/BaseModelHandler/" class="md-nav__link">
        BaseModelHandler
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../models/PydanticModelHandler/" class="md-nav__link">
        PydanticModelHandler
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../models/PydanticParserModelHandler/" class="md-nav__link">
        PydanticParserModelHandler
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-define-data-models" class="md-nav__link">
    1. Define data models
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-queue-configuration" class="md-nav__link">
    2. Queue configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-initialize-the-engine" class="md-nav__link">
    3. Initialize the Engine
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-decorate-the-function" class="md-nav__link">
    4. Decorate the function
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-run-application" class="md-nav__link">
    5. Run application
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="getting-started">Getting Started<a class="headerlink" href="#getting-started" title="Permanent link">&para;</a></h1>
<p>This is a basic example of a common pattern, an application that consumes from a kafka topic and publishes to another kafka topic. The example application receives a list of floats in a message from the input Kafka topic and publishes the maximum value from that list to the output Kafka Topic. Volley treats Kafka topics like queues, so the term "queue" and "topic" will be used interchangeably.</p>
<h3 id="1-define-data-models">1. Define data models<a class="headerlink" href="#1-define-data-models" title="Permanent link">&para;</a></h3>
<p>Let's define two Pydantic models; one for the input and one for the output Kafka topic. We'll build the application such that it sends/receives these two objects from Volley.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># my_models.py</span>
<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span>

<span class="k">class</span> <span class="nc">InputMessage</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the incoming data&quot;&quot;&quot;</span>

    <span class="n">list_of_values</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>


<span class="k">class</span> <span class="nc">OutputMessage</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the outgoing data&quot;&quot;&quot;</span>

    <span class="n">max_value</span><span class="p">:</span> <span class="nb">float</span>
</code></pre></div>
<h3 id="2-queue-configuration">2. Queue configuration<a class="headerlink" href="#2-queue-configuration" title="Permanent link">&para;</a></h3>
<p>Let's create a dictionary of configurations for each Kafka topic. Each key in the dictionary contains the configurations for that topic. These configurations define the relationship between your application and the queue, and generally determine how your application will consume/produce to the queue, and how it wants to parse the data to/from the queue. See also <a href="../queue_config/">queue configuration</a> for more detailed explanation of queues</p>
<p>First, let's define the configuration for the "input-queue".</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">my_models</span> <span class="kn">import</span> <span class="n">InputMessage</span>
<span class="c1"># app.py</span>
<span class="n">input_topic_cfg</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;incoming.kafka.topic&quot;</span><span class="p">,</span>
    <span class="s2">&quot;consumer&quot;</span><span class="p">:</span> <span class="s2">&quot;volley.connectors.ConfluentKafkaConsumer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;serializer&quot;</span><span class="p">:</span> <span class="s2">&quot;volley.serializers.OrJsonSerialization&quot;</span><span class="p">,</span>
    <span class="s2">&quot;model_handler&quot;</span><span class="p">:</span> <span class="s2">&quot;volley.models.PydanticModelHandler&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data_model&quot;</span><span class="p">:</span> <span class="n">InputMessage</span><span class="p">,</span>
    <span class="s2">&quot;config&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;group.id&quot;</span><span class="p">:</span> <span class="s2">&quot;my-consumer-group&quot;</span><span class="p">,</span>
        <span class="s2">&quot;bootstrap.servers&quot;</span><span class="p">:</span> <span class="s2">&quot;kafka:9092&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p><code>input-topic</code> is what we'll use to refer to this topic in our application. </p>
<p><code>value</code> is actual name of the topic on the broker. </p>
<p><a href="../connectors/kafka/#ConfluentKafkaConsumer"><code>consumer</code></a> refers to the class which defines how we will consume a message from this topic.</p>
<p><a href="../serializers/JsonSerialization/"><code>serializer</code></a> is what we'll use to serialize the data from bytes </p>
<p><a href=".models/"><code>data_model</code></a> is the class that define schemas for data on the topics</p>
<p><a href="../models/PydanticModelHandler/"><code>model_handler</code></a> tells Volley how to create an instance of your <code>data_model</code> with the data returned from the <code>serializer</code>.</p>
<p><code>config</code> are value to pass directly to the connector constructors. In this case, we are using Confluent's consumer, so these values directly to the config values supported by <a href="https://github.com/edenhill/librdkafka/blob/master/CONFIGURATION.md">librdkafka</a></p>
<p>Volley has built in support for <a href="../connectors/overview/"><code>consumer</code></a> (and <a href="../connectors/overview/"><code>producer</code></a>) <a href="../serializers/overview/"><code>serializer</code></a>, <code>data_model</code> and <a href="../models/overview/"><code>model_handler</code></a>. These values are all dot paths to classes. You can <a href="../extending/">extend</a> Volley with your own classes for all of this functionality.</p>
<p>Next, let's do the same for the "output-topic", but instead of defining all of the config attributions, let's use a <a href="../profiles/">Profile</a>. Profiles are pre-set groups of configuration to make it easier to decide how to handle the interaction with the queue.</p>
<p>For the "output-topic", let's use the <a href="../profiles/#confluent"><code>confluent</code></a> <code>profile</code>, which sets the consumer, producer, serializer, model_handler, and data_model for us. However, instead of using the data_model provided by the <code>confluent</code> Profile, let's override it with the Pydantic <code>data_model</code> we defined earlier.</p>
<p>Profiles (currently) do not include <code>config</code> attributes, so we still need to set those.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># app.py</span>
<span class="kn">from</span> <span class="nn">my_models</span> <span class="kn">import</span> <span class="n">OutputMessage</span>
<span class="n">output_topic_cfg</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;outgoing.kafka.topic&quot;</span><span class="p">,</span>
    <span class="s2">&quot;profile&quot;</span><span class="p">:</span> <span class="s2">&quot;confluent&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data_model&quot;</span><span class="p">:</span> <span class="n">OutputMessage</span><span class="p">,</span>
    <span class="s2">&quot;config&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;bootstrap.servers&quot;</span><span class="p">:</span> <span class="s2">&quot;kafka:9092&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="3-initialize-the-engine">3. Initialize the Engine<a class="headerlink" href="#3-initialize-the-engine" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">volley</span> <span class="kn">import</span> <span class="n">Engine</span>

<span class="n">queue_config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;input-topic&quot;</span><span class="p">:</span> <span class="n">input_topic_cfg</span><span class="p">,</span>
    <span class="s2">&quot;output-topic&quot;</span><span class="p">:</span> <span class="n">output_topic_cfg</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span>
    <span class="n">app_name</span><span class="o">=</span><span class="s2">&quot;my_volley_app&quot;</span><span class="p">,</span>
    <span class="n">input_queue</span><span class="o">=</span><span class="s2">&quot;input-topic&quot;</span><span class="p">,</span>
    <span class="n">output_queues</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;output-topic&quot;</span><span class="p">],</span>
    <span class="n">queue_config</span><span class="o">=</span><span class="n">queue_config</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
<p>When we instantiate <code>Engine()</code>, we specify which of the queues we want to treat as inputs and which are outputs. Notice we can have any number of outputs, but only one input. However, the input queue can be a target in the output_queues. If we do that, we just need to make sure the configuration provides a producer either explicitly or through a Profile.  <code>app_name</code> translates to labels used in logging and <a href="../metrics/">metrics</a>.</p>
<h3 id="4-decorate-the-function">4. Decorate the function<a class="headerlink" href="#4-decorate-the-function" title="Permanent link">&para;</a></h3>
<p>Apply the Engine's decorator to your function.</p>
<p>Volley 
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span>

<span class="kn">from</span> <span class="nn">.my_models</span> <span class="kn">import</span> <span class="n">InputMessage</span><span class="p">,</span> <span class="n">OutputMessage</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">stream_app</span>
<span class="k">def</span> <span class="nf">my_app</span><span class="p">(</span><span class="n">msg</span><span class="p">:</span> <span class="n">InputMessage</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">OutputMessage</span><span class="p">]]:</span>
    <span class="n">max_value</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">list_of_values</span><span class="p">)</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">OutputMessage</span><span class="p">(</span><span class="n">max_value</span><span class="o">=</span><span class="n">max_value</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[(</span><span class="s2">&quot;output-topic&quot;</span><span class="p">,</span> <span class="n">output</span><span class="p">)]</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="n">__main__</span><span class="p">:</span>
    <span class="n">my_app</span><span class="p">()</span>
</code></pre></div></p>
<p>When run, the function will receive a message of the type which was defined in the <code>data_model</code> in <code>queue_config</code>.</p>
<p>You produce messages by returning a list of tuples from your function.</p>
<div class="highlight"><pre><span></span><code><span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span> <span class="n">Any</span><span class="p">]]]]</span>
</code></pre></div>
<p>Each element in the list is a message destined for the queue specified by the first element in the tuple. The second tuple element is the message itself. The third tuple element is optional runtime configurations for your producer. For the Confluent producer, these might be a partition key or a callback. They are passed to the producer's <code>produce()</code> function as expanded key word arguments.</p>
<div class="codehilite"><pre><span></span><code>    [(output_queue_name, message_object, optional_runtime_configurations)]
</code></pre></div>

<p>Your application does not need to produce anything! Simply return <code>True</code> if you want Volley to mark the incoming message as a success with the consuming input queue, and <code>False</code> if you want to mark it as failed. With RSMQ, True means the incoming message will be deleted from the input queue and False results in the incoming message being returned to the input queue. See the consumer's <code>on_success</code> and <code>on_fail</code> implementations for specifics.</p>
<h3 id="5-run-application">5. Run application<a class="headerlink" href="#5-run-application" title="Permanent link">&para;</a></h3>
<p>Run it!</p>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>-m<span class="w"> </span>app
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href=".." class="md-footer__link md-footer__link--prev" aria-label="Previous: Volley" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Volley
            </div>
          </div>
        </a>
      
      
        
        <a href="../queue_config/" class="md-footer__link md-footer__link--next" aria-label="Next: Queues" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Queues
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.fcfe8b6d.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.b1047164.min.js"></script>
      
    
  </body>
</html>